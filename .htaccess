# Headers de sécurité pour Apache
<IfModule mod_headers.c>
    # Content Security Policy - Empêche l'exécution de scripts malveillants
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://www.gstatic.com https://cdnjs.cloudflare.com https://www.googletagmanager.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.tailwindcss.com https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com; img-src 'self' data: https:; connect-src 'self' https://www.google-analytics.com https://firestore.googleapis.com https://identitytoolkit.googleapis.com; frame-ancestors 'none';"
    
    # Empêche l'affichage du site dans des iframes (protection contre clickjacking)
    Header always set X-Frame-Options "DENY"
    
    # Protection XSS intégrée du navigateur
    Header always set X-XSS-Protection "1; mode=block"
    
    # Empêche la détection automatique du type MIME
    Header always set X-Content-Type-Options "nosniff"
    
    # Force HTTPS (si le site utilise HTTPS)
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    
    # Contrôle du référent pour protéger la vie privée
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Permissions Policy (anciennement Feature Policy)
    Header always set Permissions-Policy "camera=(), microphone=(), geolocation=(), payment=(), usb=(), autoplay=(), encrypted-media=(), fullscreen=(self)"
    
    # Cross-Origin policies
    Header always set Cross-Origin-Embedder-Policy "require-corp"
    Header always set Cross-Origin-Opener-Policy "same-origin"
    Header always set Cross-Origin-Resource-Policy "same-origin"
</IfModule>

# Protection contre l'accès direct aux fichiers sensibles
<Files "*.json">
    Require all denied
</Files>

<Files "serviceAccountKey.json">
    Require all denied
</Files>

<FilesMatch "\.(env|log|md)$">
    Require all denied
</FilesMatch>

# Bloquer l'accès au dossier debug_files
<Directory "debug_files">
    Require all denied
</Directory>

# Protection contre l'énumération des répertoires
Options -Indexes

# Masquer la version du serveur
ServerTokens Prod